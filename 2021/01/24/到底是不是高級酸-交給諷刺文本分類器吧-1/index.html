<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>這篇文章酸到發酵? 分析酸味的諷刺文本分類器 ~ | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="看著網路上一篇篇文章，是不是你也曾經一邊瀏覽一邊心裡想，天啊！這麼人也太酸了吧！喔！這篇回的真好，真的是罵人不帶髒字！  有沒有想過我們為什麼會覺得那些東西「酸」呢？  沒有，因為你只有想到你自己 (被揍 (揉揉腫包) 背後的原因是你因為過去的經驗，所以你從文本中的情境、句構、字詞中發現某些「線索」，而這些線索讓你覺得：「這個撰文者可能在諷刺人呢~」 那如果今天我們試想要教電腦怎麼樣分辨諷刺文章，">
<meta property="og:type" content="article">
<meta property="og:title" content="這篇文章酸到發酵? 分析酸味的諷刺文本分類器 ~">
<meta property="og:url" content="https://robinjlin.github.io/codingblog/2021/01/24/%E5%88%B0%E5%BA%95%E6%98%AF%E4%B8%8D%E6%98%AF%E9%AB%98%E7%B4%9A%E9%85%B8-%E4%BA%A4%E7%B5%A6%E8%AB%B7%E5%88%BA%E6%96%87%E6%9C%AC%E5%88%86%E9%A1%9E%E5%99%A8%E5%90%A7-1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="看著網路上一篇篇文章，是不是你也曾經一邊瀏覽一邊心裡想，天啊！這麼人也太酸了吧！喔！這篇回的真好，真的是罵人不帶髒字！  有沒有想過我們為什麼會覺得那些東西「酸」呢？  沒有，因為你只有想到你自己 (被揍 (揉揉腫包) 背後的原因是你因為過去的經驗，所以你從文本中的情境、句構、字詞中發現某些「線索」，而這些線索讓你覺得：「這個撰文者可能在諷刺人呢~」 那如果今天我們試想要教電腦怎麼樣分辨諷刺文章，">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://api.droidtown.co/static/memberAPP/images/loki.png">
<meta property="og:image" content="https://upload.cc/i1/2021/01/24/gowDOu.png">
<meta property="og:image" content="https://upload.cc/i1/2021/01/24/d1uAiJ.png">
<meta property="article:published_time" content="2021-01-23T16:42:34.000Z">
<meta property="article:modified_time" content="2021-01-24T10:28:02.265Z">
<meta property="article:author" content="Robin Lin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.droidtown.co/static/memberAPP/images/loki.png">
  
    <link rel="alternate" href="/codingblog/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/codingblog/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/codingblog/css/style.css">

  
    
<link rel="stylesheet" href="/codingblog/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/codingblog/" id="logo">Hexo</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/codingblog/" id="subtitle">程式小白成長記</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/codingblog/">Home</a>
        
          <a class="main-nav-link" href="/codingblog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/codingblog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜尋"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜尋"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://robinjlin.github.io/codingblog"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-到底是不是高級酸-交給諷刺文本分類器吧-1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/codingblog/2021/01/24/%E5%88%B0%E5%BA%95%E6%98%AF%E4%B8%8D%E6%98%AF%E9%AB%98%E7%B4%9A%E9%85%B8-%E4%BA%A4%E7%B5%A6%E8%AB%B7%E5%88%BA%E6%96%87%E6%9C%AC%E5%88%86%E9%A1%9E%E5%99%A8%E5%90%A7-1/" class="article-date">
  <time class="dt-published" datetime="2021-01-23T16:42:34.000Z" itemprop="datePublished">2021-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      這篇文章酸到發酵? 分析酸味的諷刺文本分類器 ~
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>看著網路上一篇篇文章，是不是你也曾經一邊瀏覽一邊心裡想，天啊！這麼人也太酸了吧！喔！這篇回的真好，真的是罵人不帶髒字！ </p>
<p>有沒有想過我們為什麼會覺得那些東西「酸」呢？ </p>
<p><del>沒有，因為你只有想到你自己</del> (被揍</p>
<p>(揉揉腫包)</p>
<p>背後的原因是你因為過去的經驗，所以你從文本中的情境、句構、字詞中發現某些「線索」，而這些線索讓你覺得：「這個撰文者可能在諷刺人呢~」</p>
<p>那如果今天我們試想要教電腦怎麼樣分辨諷刺文章，可以怎麼做呢？</p>
<p>STARTO!! </p>
<a id="more"></a>

<h3 id="準備"><a href="#準備" class="headerlink" title="準備"></a>準備</h3><ol>
<li><p>酸文 </p>
<p>是的！首先我們需要一點資料。你一定會想說好的，要準備爬蟲了吧！</p>
<p>不用~ </p>
<p>是的你沒有看錯，不用爬蟲。</p>
<p>目前資料的收集，你只需要三篇你覺得有酸的文章，然後請你三個朋友朋友幫你評評看有沒有酸就好。(沒有三個朋友嗎？我只能和你說聲，加油！再有點耐心，以後就會有朋友機器人了喔:))</p>
<p>三個朋友評完之後，你先挑出有兩個朋友覺得酸的句子，接著這些句子先經過你的「工人智慧」簡單把標點符號拿掉就可以了。我們這次先簡單的準備了600多句這樣兩人覺得酸的留言。</p>
</li>
<li><p>Loki</p>
</li>
</ol>
<p>   接著，把句子丟入Loki<br>   <img src="https://api.droidtown.co/static/memberAPP/images/loki.png" alt="loki logo"> </p>
<p>   LOKI 是一個可以幫你分類句型的工具。由卓騰語言科技研發，前面我們自己工人智慧前處理，但有了loki就可以幫你把這些句子以句型來分類。</p>
<p>   ㄟ都，幹嘛分類成句型呢？</p>
<p>   還記得嗎？我們人類自己判斷諷刺時，我們也會用句型當作其中一個工具。例如我們看到「你真棒！」感覺會比「你很棒!」要來的酸一點，那兩個的差別就再「真+adj」和「很+adj」的差別。而你把這些我們人類覺得酸的句子放入Loki，就是透過Loki來教電腦那些是我們人類覺得酸的句子。</p>
<p>   [放圖]</p>
<p>   用句型來分類的最大好處是，我們覺得酸的句型是有限的，就是某些特定的句型我們會覺得酸，所以如果電腦以後看到全新的句子，大多脫不了這些句型，例如我們現在輸入「真+adj」有很大的機會會諷刺，那不管電腦看到「你真棒！」、「他真強！」「小美真美！」等等等等，都可以被辨認出來！</p>
<p>   怎麼放入Loki 呢? 非常容易~ </p>
<ul>
<li><p>點入之後先新增一個專案，那如果我們這邊把我們的專案叫做mock_politeness<br><img src="https://upload.cc/i1/2021/01/24/gowDOu.png" alt="mock1"> </p>
<p>輸入好後，點開這裡。<br>  <img src="https://upload.cc/i1/2021/01/24/d1uAiJ.png" alt="mock2"></p>
<p>接著把這些框框打勾就好。</p>
</li>
</ul>
<p>   我們前置準備就好了</p>
<p>   幫大家複習一下~</p>
<p>   a. 準備確定酸的句子</p>
<p>   b. 丟入Loki ，把格子勾一勾</p>
<h3 id="程式"><a href="#程式" class="headerlink" title="程式"></a>程式</h3><p>接著我們要進入到寫程式了!</p>
<p>諷刺之所以會感覺有點難讓電腦做便是是因為感覺很沒有規則。有時候「你真棒」是在說你的好，但有時候卻會是諷刺你沒有這麼好！<br>那該怎麼辦呢？</p>
<p>好好用你剛剛手上的那些句子，那些會被我們辨認成諷刺的句型，這些句型會成為電腦判斷諷刺的標準。</p>
<p>好的看到這邊，是不是想打退堂鼓，因為你的machine learning, deep learning 感覺沒有準備好呢？別擔心，我們這邊不用。</p>
<p>像是我剛剛說的，我們會用我們準備的句子當作標準，所以如果一篇文章，他比對到越多這些句子，那就代表越有可能是篇酸文。</p>
<p>所以我們程式的目標就是讓電腦對對看新的文章中，有沒有剛剛我們找到的酸句型，如果有，這篇文章就得一分。一篇文章拿越高分，就代表，它越可能是酸文~</p>
<ol>
<li><p>Loki 下載程式template</p>
<p>把python 的loki 下載下來，裡面大約會有兩個東西。一個是一個 py 檔，另一個是一個叫做intent的資料夾，裡面也有一個py 檔。</p>
<p>舉例，我們剛剛這個Loki專案叫做mock_politeness，那這個大的資料夾就叫做mock_politeness。在這個mock_politeness 資料夾中，有兩個東西，一叫做intent的資料夾，另外一個叫做 mock_politeness.py。在intent裡面也有一個檔案，叫做Loki_mock_polite_2.py. </p>
<p>在程式外面的py檔 mock_politeness.py 點開，輸入你的loki帳號和token  </p>
</li>
<li><p>撰寫比對程式</p>
<ul>
<li><p>首先，開啟intent資料夾，開啟Loki_mock_polite_2.py，裡面你會看到像是以下的東西</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> utterance == <span class="string">&quot;[4萬]的[男友][你]可以嗎&quot;</span>:</span><br><span class="line">	<span class="comment">#write your code here</span></span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>再來，把所有的<code>pass</code>改成 <code> resultDICT[&quot;mock&quot;] = resultDICT[&quot;mock&quot;]+1</code></p>
<p>這邊的resultDICT 是等等新的文章進來後，loki會開始辨識它們，然後比對過後的結過存起來的地方。resultDICT 是怎麼被寫出來的呢？則可以看看剛剛intent 外的py檔。</p>
<p>而<code>resultDICT[&quot;mock&quot;] = resultDICT[&quot;mock&quot;]+1</code>的意思是，只要找到resultDICT[“mock”] 的句子的話，就加1</p>
</li>
<li><p>打開intent 外資料夾，開始寫比對程式</p>
<ul>
<li><p>首先，我們要和電腦說要從0分開始幫我們算，也就是<code>resultDICT[&quot;mock&quot;] += 0</code>，這句話要加在 <code>runLoki</code>這支function 裡面。怎麼加呢？如下，加在第一個if 內的resultDICT裡面。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">runLoki</span>(<span class="params">inputLIST</span>):</span></span><br><span class="line">	resultDICT = &#123;&#125;</span><br><span class="line">	resultDICT[<span class="string">&quot;mock&quot;</span>] =<span class="number">0</span></span><br><span class="line">	lokiRst = LokiResult(inputLIST)</span><br><span class="line">	<span class="keyword">if</span> lokiRst.getStatus():</span><br><span class="line">   		<span class="keyword">for</span> index, key <span class="keyword">in</span> <span class="built_in">enumerate</span>(inputLIST):</span><br><span class="line">       		<span class="keyword">for</span> resultIndex <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, lokiRst.getLokiLen(index)):</span><br><span class="line">           <span class="comment"># mock_polite_2</span></span><br><span class="line">           <span class="keyword">if</span> lokiRst.getIntent(index, resultIndex) == <span class="string">&quot;mock_polite_2&quot;</span>:</span><br><span class="line">               	resultDICT = Loki_mock_polite_2.getResult(key, lokiRst.getUtterance(index, resultIndex), lokiRst.getArgs(index, resultIndex), resultDICT)</span><br><span class="line">            		resultDICT[<span class="string">&quot;mock&quot;</span>] += <span class="number">0</span></span><br><span class="line">           <span class="keyword">else</span>:</span><br><span class="line">           	resultDICT = &#123;<span class="string">&quot;msg&quot;</span>: lokiRst.getMessage()&#125;</span><br><span class="line">			<span class="keyword">return</span> resultDICT </span><br></pre></td></tr></table></figure>
</li>
<li><p>在程式進入點<code>if __name__ == &quot;__main__&quot;:</code> 後撰寫比對系統，如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> 	<span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  	<span class="comment">#載入articut這個斷詞系統 </span></span><br><span class="line"> 		articut = ArticutAPI.Articut(level=<span class="string">&quot;lv2&quot;</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="comment">#articut 會把詞性一併標記，但現在我們暫時用不到這個功能，所以我們把詞型編著的規則找到，然後用re 表示出來。然後把這些詞性用 &quot;&quot;來取代</span></span><br><span class="line">pat = <span class="string">&quot;&lt;/?[a-zA-Z]+?_?[a-zA-Z]+?&gt;&quot;</span> </span><br><span class="line">  	parseResultDICT = articut.parse(inputSTR)</span><br><span class="line">inputLIST = []</span><br><span class="line">count_mock = <span class="number">0</span></span><br><span class="line">		<span class="keyword">for</span> p <span class="keyword">in</span> parseResultDICT[<span class="string">&quot;result_pos&quot;</span>]:</span><br><span class="line">  		<span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">1</span>:</span><br><span class="line">      		<span class="keyword">pass</span></span><br><span class="line">  		<span class="keyword">else</span>:</span><br><span class="line">      		inputLIST.append(re.sub(pat, <span class="string">&quot;&quot;</span>, p))</span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 因為articut 一次只能先餵20句，所以我們用20句為單位，請articut 斷好詞以後，我們就比對我們在Loki裡面的句型，有對到就加 1 </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, math.ceil(<span class="built_in">len</span>(inputLIST)/<span class="number">20</span>)):</span><br><span class="line">  		resultDICT = runLoki(inputLIST[i*<span class="number">20</span>:(i+<span class="number">1</span>)*<span class="number">20</span>])</span><br><span class="line">  		<span class="keyword">try</span>: </span><br><span class="line">      		count_mock  += resultDICT[<span class="string">&quot;mock&quot;</span>]</span><br><span class="line">  		<span class="keyword">except</span>:</span><br><span class="line">      		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">#print 出答案            </span></span><br><span class="line">  	resultDICT[<span class="string">&quot;mock&quot;</span>] = count_mock</span><br><span class="line">      print(<span class="string">&quot;酸度: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(count_mock/<span class="built_in">len</span>(inputLIST)))</span><br><span class="line"><span class="comment">#print(&quot;Result =&gt; &#123;&#125;&quot;.format(resultDICT))</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>  那~ 這個效果如何呢？<br>  如果是新聞，是長這樣</p>
<p>  如果是酸文是長這樣~</p>
<p>  就這樣，簡簡單單超級容易，運用一點點語言學知識，你就可以完成一個諷刺文本分類器惹~</p>
<p>  謝謝大家</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://robinjlin.github.io/codingblog/2021/01/24/%E5%88%B0%E5%BA%95%E6%98%AF%E4%B8%8D%E6%98%AF%E9%AB%98%E7%B4%9A%E9%85%B8-%E4%BA%A4%E7%B5%A6%E8%AB%B7%E5%88%BA%E6%96%87%E6%9C%AC%E5%88%86%E9%A1%9E%E5%99%A8%E5%90%A7-1/" data-id="ckkb14u3b00018wvxfjky8yg9" data-title="這篇文章酸到發酵? 分析酸味的諷刺文本分類器 ~" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/codingblog/2021/01/24/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">彙整</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/codingblog/archives/2021/01/">一月 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/codingblog/2021/01/24/%E5%88%B0%E5%BA%95%E6%98%AF%E4%B8%8D%E6%98%AF%E9%AB%98%E7%B4%9A%E9%85%B8-%E4%BA%A4%E7%B5%A6%E8%AB%B7%E5%88%BA%E6%96%87%E6%9C%AC%E5%88%86%E9%A1%9E%E5%99%A8%E5%90%A7-1/">這篇文章酸到發酵? 分析酸味的諷刺文本分類器 ~</a>
          </li>
        
          <li>
            <a href="/codingblog/2021/01/24/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Robin Lin<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/codingblog/" class="mobile-nav-link">Home</a>
  
    <a href="/codingblog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/codingblog/js/jquery-3.4.1.min.js"></script>



  
<script src="/codingblog/fancybox/jquery.fancybox.min.js"></script>




<script src="/codingblog/js/script.js"></script>





  </div>
</body>
</html>